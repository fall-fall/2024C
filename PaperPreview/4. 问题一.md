### 4. 问题一：确定性环境下的多周期优化模型

针对问题一，我们旨在为该乡村构建一个自2024年至2030年的最优种植方案。由于该问题的所有参数（如成本、价格、产量和需求）均被假定为稳定且已知的，我们构建一个确定性的多周期混合整数线性规划（Multi-period Mixed-Integer Linear Programming, MILP）模型。该模型能够精确刻画长达七年的种植决策、复杂的农艺约束以及两种不同的市场销售情景，以实现乡村总体经济效益的最大化。

#### 4.1 决策变量与辅助变量的定义

为构建优化模型，我们首先定义了三组核心决策变量，它们共同构成了完整的种植方案。

* $x_{ijky}$：此为模型的核心连续决策变量，代表在年份 $y$ 的季节 $k$，于地块 $i$ 安排种植作物 $j$ 的具体面积（单位：亩）。它是模型进行资源分配和效益计算的基础。
* $u_{ijky}$：这是一个0-1二进制决策变量，作为逻辑开关。当且仅当 $x_{ijky}$ 的值大于零时，$u_{ijky}$ 取值为1，否则为0。该变量的主要作用是捕捉“是否种植”这一离散决策，从而为施加管理便利性约束（如最小种植面积和地块分散度）提供支持。
* $z_{ijy}$：此为年度层面的0-1二进制决策变量。若在年份 $y$ 的任何一个季节，地块 $i$ 安排了作物 $j$ 的种植，则 $z_{ijy}$ 取值为1，否则为0。该变量的作用是将季节性的种植决策聚合到年度层面，是实现跨年度轮作约束（如忌重茬和豆类种植）的关键。

此外，我们引入两组辅助变量，用于清晰地描述销售环节的经济活动。

* $Sales_{jky}$：表示作物 $j$ 在年份 $y$ 季节 $k$ 的总产量中，按正常市场价格销售的数量（单位：千克）。
* $OverSales_{jky}$：表示作物 $j$ 在年份 $y$ 季节 $k$ 的总产量中，超出预期市场需求后，进行降价处理的销售数量（单位：千克）。

#### 4.2 目标函数的确定

模型的根本目标是最大化在整个七年规划期内的累计净利润。根据题目设定的两种不同情景，我们分别构建了对应的目标函数。

**情况一：超产部分滞销浪费**
在此情景下，超出市场预期的产量无法创造价值，因此总收益仅由正常销售部分贡献。目标函数旨在最大化正常销售收入与总成本的差额：
$$
\max \sum_{y \in Y} \sum_{k \in K} \left( \sum_{j \in J} P_j \cdot Sales_{jky} - \sum_{j \in J} \sum_{i \in I} C_j \cdot x_{ijky} \right)
$$

**情况二：超产部分降价出售**
在此情景下，超产部分仍能以50%的折扣价售出，为乡村带来额外收益。因此，目标函数中增加了由 $OverSales_{jky}$ 产生的收入项，以寻求更高的总利润：
$$
\max \sum_{y \in Y} \sum_{k \in K} \left( \sum_{j \in J} (P_j \cdot Sales_{jky} + 0.5 \cdot P_j \cdot OverSales_{jky}) - \sum_{j \in J} \sum_{i \in I} C_j \cdot x_{ijky} \right)
$$

#### 4.3 约束条件的设立

为保证种植方案的现实可行性、农艺科学性和可持续性，我们设立了以下七组严密的约束条件。

1.  **产量与销售衔接约束**: 将种植活动与市场销售连接。总产量由种植面积决定，并分解为正常销量和超产销量。在情况一中，总产量只需大于等于正常销量；在情况二中，二者严格相等。
2.  **市场需求上限约束**: 规定了正常价格销售量 $Sales_{jky}$ 不能超过该作物的市场预期需求量 $Demand_j$。
3.  **土地资源约束**: 确保任意地块 $i$ 在每个季节 $k$ 种植的所有作物总面积不超过其物理上限 $A_i$。
4.  **作物种植适宜性约束**: 通过预设的0-1参数 $S_{ijk}$，保证任何作物只能在其适宜的土地类型和季节上进行种植。
5.  **田间管理便利性约束**: 此组约束通过二进制变量 $u_{ijky}$ 将实践经验量化。它强制任何种植活动必须达到最小面积阈值 $A_{\min}$，同时限制了单一作物在单季内所能占用的最大地块数 $N_j$，以实现规模化经营并降低管理成本。
6.  **忌重茬轮作约束**: 这是保障土地长期生产力的关键。通过年度状态变量 $z_{ijy}$，模型强制任何地块 $i$ 上的同种作物 $j$ 不能连续两年种植 ($z_{ijy} + z_{ij,y+1} \le 1$)。同时，利用2023年的历史数据 $Past_{ij}$，确保2024年的计划能与过去实现平稳过渡。
7.  **豆类作物强制种植约束**: 为改良土壤，模型通过一个三年滑动窗口，强制要求每个地块 $i$ 在每连续三年内（例如2023-2025年）至少种植一次豆类作物。此约束同样与2023年的历史数据相衔接，并贯穿整个规划期。

#### 4.4 优化模型的整合呈现

综上所述，问题一的两种情景均被构建为以下形式的多周期混合整数线性规划模型。

**目标函数 (Objective Function):**
$$
\text{情况一: } \max \sum_{y,k,j} (P_j \cdot Sales_{jky} - \sum_{i} C_j \cdot x_{ijky})
$$
$$
\text{情况二: } \max \sum_{y,k,j} (P_j \cdot Sales_{jky} + 0.5 \cdot P_j \cdot OverSales_{jky} - \sum_{i} C_j \cdot x_{ijky})
$$
**约束条件 (Subject to):**
$$
\begin{align*}
& Yield_j \cdot \sum_{i \in I} x_{ijky} \ge Sales_{jky} && (\text{仅用于情况一}) \\
& Yield_j \cdot \sum_{i \in I} x_{ijky} = Sales_{jky} + OverSales_{jky} && (\text{仅用于情况二}) \\
& Sales_{jky} \le Demand_j && \forall j,k,y \\
& \sum_{j \in J} x_{ijky} \le A_i && \forall i,k,y \\
& x_{ijky} \le S_{ijk} \cdot A_i && \forall i,j,k,y \\
& x_{ijky} \le A_i \cdot u_{ijky} \text{ and } x_{ijky} \ge A_{\min} \cdot u_{ijky} && \forall i,j,k,y \\
& \sum_{i \in I} u_{ijky} \le N_j && \forall j,k,y \\
& z_{ijy} \ge u_{ijky} && \forall i,j,k,y \\
& z_{ij,2024} + Past_{ij} \le 1 && \forall i,j \\
& z_{ijy} + z_{ij,y+1} \le 1 && \forall i,j \text{ and } y \in \{2024,...,2029\} \\
& \sum_{j \in J_{bean}} (Past_{ij} + z_{ij,2024} + z_{ij,2025}) \ge 1 && \forall i \\
& \sum_{j \in J_{bean}} (z_{ijy} + z_{ij,y+1} + z_{ij,y+2}) \ge 1 && \forall i \text{ and } y \in \{2024,...,2028\} \\
& x_{ijky}, Sales_{jky}, OverSales_{jky} \ge 0 && \forall i,j,k,y \\
& u_{ijky}, z_{ijy} \in \{0, 1\} && \forall i,j,k,y
\end{align*}
$$

#### 4.5 优化模型的求解与分析

##### 4.5.1 模型求解

此模型是一个大规模的混合整数线性规划问题，其决策变量和约束数量巨大。我们将采用Python作为编程语言，利用其强大的数据处理库（如Pandas）对附件数据进行预处理。随后，借助Pyomo这一开源建模工具包将上述模型转化为标准的数学规划格式。最后，调用业界领先的商业求解器Gurobi进行高效求解。Gurobi求解器内置的分支定界、割平面和启发式算法能够有效处理此类复杂问题，在可接受的时间内找到全局最优解。

##### 4.5.2 优化模型的灵敏度分析

在确定性模型中，参数的取值对最优解的形态和目标函数值具有直接影响。然而，在现实世界中，这些参数，特别是市场价格、生产成本和作物产量，都存在一定的不确定性。因此，为了检验我们所得出的最优种植方案的稳定性与鲁棒性，并识别对该乡村经济效益影响最为关键的因素，我们设计了详尽的单因素敏感性分析流程。

敏感性分析的核心过程在于，选择模型中的关键参数，让其在一定的范围内系统性地波动，并观察最优解和目标函数值产生的相应变化。这一过程不仅能够衡量模型对参数扰动的敏感程度，还能揭示可能导致种植策略发生根本性转变的临界点。我们计划从以下三个维度选取参数进行分析。

首先是市场经济参数。我们选取了一种高价值蔬菜的销售价格 $P_j$ 和一种主要粮食作物（如玉米）的种植成本 $C_j$ 作为分析对象。价格和成本是影响农业利润最直接的外部市场因素。我们将以附件中2023年的数据为基准值，使这两个参数在其基准值的±20%区间内以5%为步长进行变化。对每一个变化值，我们都将重新求解整个优化模型，记录总利润的变化趋势。这将揭示乡村的整体收入对不同类型作物市场波动的依赖程度。

其次是农业生产参数。作物的单位面积产量 $Yield_j$ 直接受到年度气候、土壤条件等不可控自然因素的影响。我们选取一种对气候较为敏感的作物，同样让其亩产量在其基准值的±20%区间内波动。通过此项分析，我们可以评估不同程度的丰收或歉收对最优种植策略和最终收益的冲击，从而量化气候风险对农业生产系统的影响。

最后是模型内生的管理决策超参数。模型中的最小种植面积 $A_{\min}$ 和最大地块分散度 $N_j$ 是我们为量化管理便利性而引入的超参数。这两个参数的取值带有一定的主观性，因此有必要分析其对模型结果的影响。我们将设定若干个合理的 $A_{\min}$ 和 $N_j$ 取值组合，分别求解模型。此举旨在探索管理约束的松紧程度如何在总利润和种植方案的集中化、规模化形态之间进行权衡，为决策者在“管理成本”与“理论最优收益”之间做出选择提供数据支持。

[//]: # (TODO: 进行灵敏度分析的可视化)
对于每一项分析，我们都将结果绘制成清晰的二维图表。图表的横轴为参数的百分比变化率，纵轴为最优目标函数值（即七年总利润）。通过曲线的斜率，可以直观地判断敏感性的强弱：斜率越大，表明总利润对该参数的变化越敏感。更重要的是，我们将密切关注图表中可能出现的“拐点”或“跳跃点”，这些点位往往意味着最优种植策略发生了结构性改变。通过识别并分析这些临界阈值，我们可以为乡村管理者提供更具前瞻性的决策参考，例如，某种蔬菜的价格下降到何种程度时，就应当果断地将其替换为其他作物。

综上所述，这一系列的敏感性分析将构成我们模型验证与评估的重要组成部分。它不仅验证了方案的可靠性，更将模型的静态结果转化为动态的、富有洞察力的决策支持工具，从而极大地提升了研究的现实指导意义。